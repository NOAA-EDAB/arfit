<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>arfit • arfit</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="arfit">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">arfit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/arfit.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/background_work.html">Background</a></li>
    <li><a class="dropdown-item" href="../articles/Equations.html">Equations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andybeet/arfit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>arfit</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andybeet/arfit/blob/main/vignettes/arfit.Rmd" class="external-link"><code>vignettes/arfit.Rmd</code></a></small>
      <div class="d-none name"><code>arfit.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">arfit</span><span class="op">)</span></span></code></pre></div>
<p>An example is bundled with the package. The example uses mean
riverflow discharge data from USGS station #05464500 Cedar River at
Cedar Rapids, IA. (For full details see <span class="citation">@Beet_2022</span>)</p>
<p>The null model is fit:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  Y_t = \alpha + \epsilon_t  
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>t</mi></msub><mo>=</mo><mi>ϕ</mi><msub><mi>ϵ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>Z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_t = \phi\epsilon_{t-1} + Z_t</annotation></semantics></math>
is a stationary first order autoregressive process with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z_t \sim N(0,\sigma^2)</annotation></semantics></math></p>
<p>The alternative model is fit:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>t</mi><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  Y_t = \alpha + \beta t + \epsilon_t  
\end{equation}</annotation></semantics></math></p>
<p>The parameters are estimated using maximum likelihood estimation. The
log-likelihood is given as</p>
<p><span class="math display">$$\begin{align}
logL\left( \beta, \phi; \underline{y} \right ) = &amp;constant +
\frac{1}{2}log(1-\phi^2) \notag \\
&amp;-\frac{n}{2}log\left( (1-\phi^2)(y_1-\beta)^2 + \sum^n_{t=2}(y_t -
\phi y_{t-1}-t\beta + \phi(t-1)\beta)^2 \right)
\end{align}$$</span></p>
<p>The log likelihoods are evaluated for each fitted model and
likelihood ratio statistic is calculated as minus twice the difference
between the likelihood under the null model and the alternative
model.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>=</mo><mo>−</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>L</mi><msub><mi>H</mi><mn>0</mn></msub></msub><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>L</mi><msub><mi>H</mi><mn>1</mn></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{equation}
  \Delta =  -2(logL_{H_0}-logL_{H_1}) 
\end{equation}</annotation></semantics></math></p>
<p>To evaluate the significance of the statistic,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>,
a parametric bootstrap is performed. Simulate a new data set from the
model fitted under the null. Fit the null and the alternative models to
the simulated data and evaluate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>b</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{boot}</annotation></semantics></math>.
Repeat this simulation procedure a large number of times and estimate
the significance level (P-value) by the proportion of simulated data
sets for which the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>b</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{boot}</annotation></semantics></math>
is larger than that of the observed data.</p>
<p>For the Cedar Rapids example, 999 bootstrap samples are
performed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_cedar_rapids.html">example_cedar_rapids</a></span><span class="op">(</span>nBootSims <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></code></pre></div>
<p><img src="figures%2FFigure1.png"><!-- --></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andy Beet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
